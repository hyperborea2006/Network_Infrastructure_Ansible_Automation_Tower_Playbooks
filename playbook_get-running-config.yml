---
- name: Retrieve running config from Cisco IOS switches
  gather_facts: no  # typically not needed for network devices
  connection: network_cli
  vars:
    ansible_network_os: ios
  tasks:
    - name: Get running configuration from Cisco switch with cli_command
      ansible.netcommon.cli_command:
        command: show running-config
      register: running_config_output

    - name: Save running config to file
      copy:
        content: "{{ running_config_output.stdout[0] }}"
        dest: "./configs/{{ inventory_hostname }}-running-config.txt"